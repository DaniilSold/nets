# ADR 0003: Windows сбор через ETW + WFP

## Решение
Использовать ETW провайдер `Microsoft-Windows-TCPIP` для телеметрии потоков и Windows Filtering Platform (WFP) callout для карантина.

## Контекст
* Нужна точная привязка PID/процесса к сокетам.
* WFP предоставляет программируемые фильтры без вмешательства в драйверы NIC.

## Альтернативы
* NDIS Lightweight Filter — сложнее в разработке и сертификации.
* WinPcap/Npcap polling — не даёт PID, высокие накладные расходы.

## Обоснование
ETW обеспечивает детализированные события TCP/UDP/ICMP и ARP. WFP позволяет динамически блокировать трафик конкретного процесса и безопасно откатывать правила.

## Последствия
* Требуется подпись драйверов WFP callout.
* Приложению нужны привилегии Administrator для регистрации провайдеров.
